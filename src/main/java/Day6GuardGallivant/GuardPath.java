package Day6GuardGallivant;

import java.util.HashSet;
import java.util.Set;

public class GuardPath {
    public static void main(String[] args) {
        String mapInput =
                "........#.............................#......#................#..................#..................#.........#.#.#...............\n" +
                "...........................................#..#......................#............................#...........................#.#.\n" +
                ".............#..........#........#.#...........#........................#............................##...........................\n" +
                "............#.............#.....................................#........................#.....#..................................\n" +
                ".........#...........#................#................................#......#.....................#.............#..............#\n" +
                "...........................##...........................................................................................#.........\n" +
                "...........#.......#.................................................................#..............#....................#........\n" +
                ".......................#.............................................#.........................................#.#..............#.\n" +
                ".#...................#..................#...........#...#.........#...##..........................................................\n" +
                ".................#..........#.....#.........#.....................................................................#..........##...\n" +
                "....#.#............#..........#.......................#.........................#.................#.........#.............#....#..\n" +
                "...#....................................#.............#..............................#............#.....................#........#\n" +
                "....................#..............................#...#.#...#.#..........#.................................#..................#..\n" +
                "........................................................................................#.....#.........#............#.........#..\n" +
                "...................#.................#.......................................................................................#...#\n" +
                "..............#.......#..................#........#....#........#.....................#..........................#................\n" +
                "...........#..#....................................#.............#.#..#.......................................#.........#.#...#...\n" +
                "...#.............#............................#..............#....................#.#.............................................\n" +
                "..#...........#.#.........#...............................................#...#...............#.#...........#........##....#......\n" +
                ".............................................#..#.........#......#................................................................\n" +
                ".................................#.................#..............#.....#...................................................#.....\n" +
                "............................#.......#............#...............................................................#................\n" +
                ".....#....................#...........................................#..........................#..........#..#...#......#...#...\n" +
                "........................#......#...#.......................#....##.......#..........#...............#.............................\n" +
                "#..#....................................................................................................#.........................\n" +
                "...........................................#......#..........................#..............................#.............#.....#.\n" +
                "..............#......................#..#...................................#.#..................#.......#............#...........\n" +
                ".................#...................................#..........#......#....#.#.#...#....................#..........#......#......\n" +
                "........#....................................#........#.........................................#......#.#...............#......#.\n" +
                "..................................#......#........#........#.#......#.........................#.#.......#......................#..\n" +
                "......#..#.........#............#...........................................................#.............#.........#.............\n" +
                ".........................#......................#.....#........#..........#.......................................................\n" +
                "#.......#..................#............................................................#.........................................\n" +
                ".........#.....#.............#...............#......#.....................#.......................................................\n" +
                ".........#..#.........................................................#.........##..................##........#...................\n" +
                ".#.....#..............#..............#.........................................#.....................................#............\n" +
                "..............................#......................................................................................#............\n" +
                "..............#..........................#................................#.#.....#...........#.........#.........................\n" +
                "....................#...#.#...........................................................................#...........#...............\n" +
                "...........#.............................#....................#........#...............................##....#....................\n" +
                ".....................#......................#.#.....#...........................#.......#........#................................\n" +
                "#..........#...............#.......#..................................#.....................................................##....\n" +
                ".........................................................#...#....#...............................................#.........##....\n" +
                ".....................#......................#..............#..................................................#...................\n" +
                "......#.............#........#..................................................#...#.............................#......#........\n" +
                "....................#............#........#...............#......#.......#........................................................\n" +
                "..........................................................................#........................#......#.............#.......#.\n" +
                ".....................................................#..#........#....................#.....................#.....................\n" +
                "..#.................#........................................#................................................##...............#..\n" +
                ".............#......#.........#................................................................................#..................\n" +
                "#......#.......................................................................................................#......#...........\n" +
                ".......##.......................#...................#.........##..........#.............................#........................#\n" +
                "...........................................................#................................#...............#............##.......\n" +
                "..........................#...................#...........................................................#.............#........#\n" +
                "...#......................#..##................................................................................................#..\n" +
                "............#..#.........#...#.........................................................#........#..............#..................\n" +
                ".................#.................#........#............................................................................#........\n" +
                "............#..#..#..#....#...........................#.................................................#..#...................#..\n" +
                "....................................................#..#.................................#.#..............................#.......\n" +
                ".........#.#................................................#..#............................................................#.....\n" +
                "...##............................................#.....#.#...........................#....#.................#.#..........#........\n" +
                "...............#.#.#.........................................#......#.....#..............................................#....#...\n" +
                ".............#........................................#....#.......................................#...#....#.....................\n" +
                "...........#.................................#...............................................#...........#..#..#......#...........\n" +
                "#.......................................###....#....#.........................................#......#.............#..............\n" +
                "...............#.#.....................................................................................#....................#.....\n" +
                "##.........#..............#................................#..#..#..........#....................#..#..........#.....#............\n" +
                "...................#..........................................#........................#.......................................#..\n" +
                "#........#.#.....#............................................................##......#....#...........................#..........\n" +
                "...............##....#.............#......................................#......................#...................#.#..........\n" +
                "....................................##....#.............................................#..........#...................#....#.....\n" +
                ".....#...............#........#..............#.............#..#..#...#.................................................#.#...##...\n" +
                "........##.....................................................#..................................................................\n" +
                ".........#.............................................................#..........................................................\n" +
                ".............#.............#............................................................................#....#..........#.......#.\n" +
                ".#........#...........................................#....#.........#......#............#.#................................#....#\n" +
                "...............................................#.......#.............#.............#....................#.....................#...\n" +
                "......................................#....................................................#...................................#..\n" +
                "....#........#.....................................................#.......................................##.....................\n" +
                "..........................................#............................................#.......#.....................#...#........\n" +
                "................#.#.............#.....#....................#............#.............................................#...........\n" +
                "..............................#..............#.................#...................#...#.......#..................................\n" +
                ".#...............................................................#..................#......#............#................#........\n" +
                "...................................#.................................##...........................................................\n" +
                "...............................................................#....#..##...................#..#..............................#...\n" +
                "..............................#...........#.................................................#.#....#...............#.....#........\n" +
                "............................#........#.........#.........................................#....#...................................\n" +
                "........................#................................................#....#..............#.........................#..........\n" +
                ".........#....#....................#.......................#.#.......................................................#............\n" +
                ".........................#......................................................#.................................................\n" +
                ".............#...#...........#...................#.#..............^........................................#....#.................\n" +
                ".................##...............................................................................................................\n" +
                "..................#......#..............................#...............#.##.........................#............................\n" +
                "....................................................###...........................................................................\n" +
                "........#....................................................#........#........................................##...#.......#.....\n" +
                ".........................##.....#.........................................................................#.........#.............\n" +
                ".................#...........................................................................#........#..............#..#.........\n" +
                ".........#.#..................................#..#...................................#.................................#..........\n" +
                ".....#............#...#............#..............................#..........#.........#....#...........#.........................\n" +
                "#...#...........................................................................................#.....#....#.........#.....#......\n" +
                "......................................................#.#...............#......#.................#...............#.............#..\n" +
                ".......................................................................................#.........#...#...........#..............#.\n" +
                ".........................#................#.................#...............................#........#.##....................#....\n" +
                ".....#...#................................#......................#...........#........................................#..#........\n" +
                ".................#................................#.#.....................#............................................#....#.....\n" +
                "...................#............................................................................#........#.....................##.\n" +
                ".....#.................................................................#..................#........#.......#...#..................\n" +
                "...............................#..#...................................#..........#...........#......................#.............\n" +
                "....#................#..................#..........................................................................#........#.....\n" +
                "......#.........................#............................................#....................#....#..........................\n" +
                ".#.......#....#.#...#....#................#........................#...................#...................#......#...............\n" +
                "..#...................#......#.#........#.........................#.........................#............#........................\n" +
                "..#....#...#.......................................................................#......................#....................#..\n" +
                ".......#...#............................................................#.................#......................................#\n" +
                "..##..........#..................#...............#.....#..#...........#....#...............................................#......\n" +
                "...##....#............##..................................................................................................#.......\n" +
                "...........#.........................#....#......#...#.............................................#....................#........#\n" +
                "............................................................................#...............#..#..............#...................\n" +
                ".....#............................#.....................................................................................#......#.#\n" +
                ".........#.............................#.....#.........................................................#.#.....#..................\n" +
                ".......................#..#.#.......#..#................................#.....#..............#.........................#..........\n" +
                ".................#.....................#............................................................................#........#....\n" +
                "........#...............................................................#....#........#.........#.......#......#......#...........\n" +
                "..............#............#......#..............#.#...........#.............................##...##.#..............#.....#.......\n" +
                "##....................................................................#.......................#.................#.................\n" +
                "............#...................................................................................................................#.\n" +
                "...#....#....................#..............................................................................#........#............\n" +
                "....#......................#......................................................#...............................................\n" +
                ".#...#...........#....#........#...#.................#..............................#................#.##.........................\n" +
                "...#.................#..............................#................................#...........#................................";

        String[] map = mapInput.split("\n");

        int startX = 0;
        int startY = 0;
        char direction = '^';

        for (int y = 0; y < map.length; y++) {
            for (int x = 0; x < map[y].length(); x++) {
                char c = map[y].charAt(x);
                if (c == '^' || c == '>' || c == '<' || c == 'v') {
                    startX = x;
                    startY = y;
                    direction = c;
                    break;
                }
            }
        }

        Set<String> visited = new HashSet<>();
        visited.add(startX + "," + startY);

        int [][] directions = {{-1, 0}, {0, 1}, {1, 0}, {0, -1}};
        int dirIndex = switch (direction) {
            case '^' -> 0;
            case '>' -> 1;
            case 'v' -> 2;
            case '<' -> 3;
            default -> throw new IllegalStateException("Unexpected direction: " + direction);
        };

        while (true) {
            int nextX = startX + directions[dirIndex][1];
            int nextY = startY + directions[dirIndex][0];

            if (nextX < 0 || nextX >= map[0].length() || nextY < 0 || nextY >= map.length) {
                break;
            }

            if (map[nextY].charAt(nextX) == '#') {
                dirIndex = (dirIndex + 1) % directions.length;
                continue;
            }

            startX = nextX;
            startY = nextY;

            visited.add(startX + "," + startY);
        }

        System.out.println("Places guard visited : " + visited.size());
    }
}
